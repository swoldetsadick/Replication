csur92 <- read.table("./csur92.txt", header = TRUE)
csur95 <- read.table("./csur95.txt", header = TRUE)
csur98 <- read.table("./csur98.txt", header = TRUE)
csur01 <- read.table("./csur01.txt", header = TRUE)
merge7 <- merge(merge(csur92, csur95, all.x = TRUE, all.y = TRUE), merge(csur98, csur01, all.x = TRUE, all.y = TRUE), all.x = TRUE, all.y = TRUE)
merge7 <- merge7[order(merge7$identif, merge7$anno),]
### Generating lags
library(lubridate)
merge7 <-  within(merge7, {
detab <- ave(eta, identif, FUN = function(x) c(NA, diff(x)))
roa1 <- ave(roa, identif, FUN = function(x) c(NA, x[-length(x)]))
danno <- ave(year(merge7$anno), identif, FUN = function(x) c(NA, diff(x)))
})
merge7$dip <- ifelse(year(merge7$anno)==1989,merge7$dip89,ifelse(year(merge7$anno)==1990,merge7$dip90,ifelse(year(merge7$anno)==1991,merge7$dip91,ifelse(year(merge7$anno)==1992,merge7$dip92,ifelse(year(merge7$anno)==1993,merge7$dip93,ifelse(year(merge7$anno)==1994,merge7$dip94,ifelse(year(merge7$anno)==1995,merge7$dip95,ifelse(year(merge7$anno)==1996,merge7$dip96,ifelse(year(merge7$anno)==1997,merge7$dip97,ifelse(year(merge7$anno)==1998,merge7$dip98,ifelse(year(merge7$anno)==1999,merge7$dip99,merge7$dip00)))))))))))
library(foreign)
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
summary(merge7$roa1 - aljen$roa1)
sum(is.na(merge7$roa1)) - sum(is.na(aljen$roa1))
sum(is.na(merge7$detab)) - sum(is.na(aljen$detab))
summary(merge7$detab - aljen$detab)
identical(merge7$anno,aljen$anno)
library(lubridate)
identical(year(merge7$anno),aljen$anno)
class(year(merge7$anno))
identical(year(merge7$anno),as.integer(aljen$anno))
identical(year(merge7$danno),as.integer(aljen$danno))
class(merge7$danno)
identical(merge7$danno,as.integer(aljen$danno))
summary(merge7$dip - aljen$dip)
sum(is.na(merge7$dip)) - sum(is.na(aljen$dip))
merge7$identif <- as.factor(merge7$identif)
# Creating identif LAG by identif
E <- data.frame(as.factor(merge7$identif))
G <- data.frame(rbind(as.character(NA), E))
G <- data.frame(G[-nrow(G),])
H <- data.frame(cbind(E, G))
colnames(H) <- c("nlg", "lg1")
H$rl <- ifelse(H$nlg == H$lg1, as.character(H$nlg), NA)
# Creating identif LEAD by identif
I <- data.frame(rbind(E, as.character(NA)))
I <- data.frame(I[-1,])
J <- data.frame(cbind(E, I))
colnames(J) <- c("nad", "ad1")
J$ra <- ifelse(J$nad == J$ad1, as.character(J$nad), NA)
# identif LAG is called id1 and LEAD id3 (by identif)
merge7$id1 <- H$rl
merge7$id3 <- J$ra
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
identical(aljen$id1, merge7$id1)
identical(aljen$id3, merge7$id3)
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
identical(aljen$id1, merge7$id1)
class(aljen$id1)
class(merge7$id1)
identical(as.character(aljen$id1), merge7$id1)
b <- c(aljen$id1, merge7$id1)
b <- data.frame(c(aljen$id1, merge7$id1))
b <- data.frame(cbind(aljen$id1, merge7$id1))
View(b)
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
identical(aljen$id1, merge7$id1)
identical(as.character(aljen$id1), merge7$id1)
b <- data.frame(cbind(aljen$id1, merge7$id1))
View(b)
head(aljen)
View(b)
head(aljen$identif,15)
head(merge7$identif,15)
head(merge7$id1,15)
head(aljen$id1,15)
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
head(aljen$lid,15)
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
head(aljen$id1,15)
head(merge$id1,15)
head(merge7$id1,15)
identical(as.character(aljen$id1),merge7$id1)
summary(as.numeric(aljen$id1) - as.numeric(merge7$id1))
b <- data.frame(cbind(aljen$id1, merge7$id1))
View(b)
class(b)
class(b$X1)
class(b$X2)
b$d <- identical(b$X1,b$X2)
View(b)
b$d <- identical(as.factor(b$X1),as.factor(b$X2))
View(b)
summary(b$d)
b$d <- identical(as.factor(b$X1) - as.factor(b$X2))
View(b)
b$X1 <- as.numeric(b$X1)
View(b)
b$X2 <- as.numeric(b$X2)
View(b)
b$d <- identical(as.factor(b$X1),as.factor(b$X2))
View(b)
b$d <- identical(b$X1,b$X2)
View(b)
b$d <- (b$X1-b$X2)
View(b)
b <- data.frame(cbind(as.character(aljen$id1), as.character(merge7$id1)))
View(b)
class(b$X1)
a <- as.character(aljen$id1)
b <- as.character(merge7$id1)
c <- data.frame(c(a, b))
c <- data.frame(cbind(a, b))
View(c)
class(c$a)
class(c$b)
class(a)
class(b)
c <- identical(a,b)
a <- as.numeric(aljen$id1)
b <- as.numeric(merge7$id1)
c <- a-b
d <- data.frame(cbind(a, b, c))
View(d)
summary(d$c)
summary(c)
e <- subset(d, d$c != 0| !is.na(d$c))
View(e)
e <- subset(d, d$c == 0)
f <- subset(d, is.na(d$c))
View(f)
View(e)
13467+13770
43718-27237
e <- subset(d, d$c != 0)
View(e)
summary(as.numeric(merge7$identif)-as.numeric(aljen$identif))
aljen <- read.dta("C:/Users/anton_000/Documents/Downloads/Desktop/compare/maka.dta")
summary(as.numeric(merge7$identif)-as.numeric(aljen$identif))
class(merge7$identif)
class(aljen$identif)
